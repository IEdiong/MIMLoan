@page "/success/{ApplicationId:int}"

<PageTitle>Success</PageTitle>

<h3 class="text-center text-success mt-5">Application Submitted Successfully!</h3>
<p class="text-center">Thank you for applying. Your application will now be evaluated.</p>

@if (_loanCalculation != null)
{
    <div class="loan-details">
        <h3>Loan Details</h3>
        <p><strong>Loan Amount:</strong> @_loanCalculation.LoanAmount.ToString("C")</p>
        <p><strong>Term:</strong> @_loanCalculation.TermMonths months</p>
        <p><strong>Monthly Interest Rate:</strong> @(_loanCalculation.MonthlyInterestRate * 100)%</p>

        <h3>Repayment Information</h3>
        <p><strong>Number of Repayments:</strong> @_loanCalculation.TermMonths</p>
        <p><strong>Monthly Repayment Amount:</strong> @_loanCalculation.MonthlyRepayment.ToString("C")</p>
        <p><strong>Total Amount Payable:</strong> @_loanCalculation.TotalPayable.ToString("C")</p>
    </div>
}
else
{
    <p><em>Loading loan details...</em></p>
}


@code {
    [Parameter] 
    public int ApplicationId { get; set; }

    private LoanCalulationResultDto? _loanCalculation;

    protected override async Task OnInitializedAsync()
    {
        var application = await LoanService.GetApplicationByIdAsync(ApplicationId);
        if (application != null)
        {
            _loanCalculation = LoanCalculatorService.CalculateLoan(application.LoanAmount);
        }
    }
}